{"version":3,"file":"public/scripts/app.js","sources":["app/application.js","app/collections/receipts.js","app/initialize.js","app/locales/en.js","app/locales/fr.js","app/models/receipt.js","app/router.js","app/templates/coach.jade","app/templates/control.jade","app/templates/data.jade","app/templates/home.jade","app/templates/info.jade","app/templates/stats.jade","app/views/app_view.js","app/views/coach_view.js","app/views/control_view.js","app/views/data_view.js","app/views/info_view.js","app/views/stats_view.js"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAPA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AALA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AApCA;;A,CCAA;;AACA;AACA;AACA;AAHA;;A,CCAA;;AACA;AACA;AACA;AAHA;;A,CCAA;;AACA;AACA;AACA;AAHA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA/CA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AARA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAbA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAVA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AARA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAZA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAVA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA1EA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAzBA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAnEA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA5EA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAnBA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAnVA;;A","sourcesContent":["module.exports = {\n\n    initialize: function() {\n        var Router = require('router');\n        this.router = new Router();\n        Backbone.history.start();\n    }\n};","Receipt = require('../models/receipt');\nmodule.exports = ReceiptDetails = Backbone.Collection.extend({\n    model: Receipt,\n    url: 'receipts'\n})\n","// The function called from index.html\n$(document).ready(function() {\n    var app = require('application');\n\n    var locale = 'fr'; // default locale\n\n    // we'll need to tweak the server to allow this\n    $.ajax('cozy-locale.json', {\n        success: function(data) {\n            locale = data.locale\n            initializeLocale(locale);\n        },\n        error: function() {\n            initializeLocale(locale);\n        }\n    });\n\n    // let's define a function to initialize Polyglot\n    var initializeLocale = function(locale) {\n        var locales = {};\n        try {\n            locales = require('locales/' + locale);\n        }\n        catch(err) {\n            locales = require('locales/en');\n        }\n\n        var polyglot = new Polyglot();\n        // we give polyglot the data\n        polyglot.extend(locales);\n\n        // handy shortcut\n        window.t = polyglot.t.bind(polyglot);\n        app.initialize();\n    };\n});\n","module.exports = {\n    \"main title\": \"Welcome to MyInfo Nutritional\",\n    \"main description\": \"This application will help you track your shopping from nutrional point of view!\",\n}","module.exports = {\n    \"main title\": \"Bienvenue sur MesInfos Nutritionelles\",\n    \"main description\": \"Cette application vous permet de suivre vos achats en termes nutrionnels. !\",\n}","module.exports = Receipt = Backbone.Model.extend({\n\n})\n","var AppView = require('views/app_view');\nvar ReceiptCollection = require('collections/receipts');\n\nvar receipts = new ReceiptCollection();\nvar mainView;\n\nmodule.exports = Router = Backbone.Router.extend({\n\n    routes: {\n        '': 'info',\n        'info': 'info',\n        'stats': 'stats',\n        'coach': 'coach',\n        'control': 'control',\n        '*path' : 'main'\n    },\n\n    main: function() {\n        this.mainView = new AppView({\n            collection: receipts\n        });\n        this.mainView.render();\n    },\n    \n    info: function(){\n    \tif(!this.mainView)\n    \t\tthis.main();\n    \tthis.mainView.infoView();\n    },\n    \n    stats: function(){\n    \tif(!this.mainView)\n    \t\tthis.main();\n    \tthis.mainView.statsView();\n    },\n    \n    coach: function(){\n    \tif(!this.mainView)\n    \t\tthis.main();\n    \tthis.mainView.coachView();\n    },\n    \n    control: function(){\n    \tif(!this.mainView)\n    \t\tthis.main();\n    \tthis.mainView.controlView();\n    }\n});","module.exports = function anonymous(locals, attrs, escape, rethrow, merge) {\nattrs = attrs || jade.attrs; escape = escape || jade.escape; rethrow = rethrow || jade.rethrow; merge = merge || jade.merge;\nvar buf = [];\nwith (locals || {}) {\nvar interp;\nbuf.push('coach');\n}\nreturn buf.join(\"\");\n};","module.exports = function anonymous(locals, attrs, escape, rethrow, merge) {\nattrs = attrs || jade.attrs; escape = escape || jade.escape; rethrow = rethrow || jade.rethrow; merge = merge || jade.merge;\nvar buf = [];\nwith (locals || {}) {\nvar interp;\nvar MesInfoNutritionelles = (\"<strong> <span style='font-style:italic'>Mes Infos</span> Nutritionnelles</strong>\");\nvar OpenFoodFacts = (\"<strong><span style='color:red'>Ope</span><span style='color:orange'>nFoo</span><span style='color:green'>dFac</span><span style='color:blue'>ts</span></strong>\");\n{\nbuf.push('<div class=\"header\"><div class=\"container\"><div class=\"row\"><div class=\"col-md-11\"><H2><span>Controle des données nutritionnelles</span></H2></div><div class=\"col-md-1\"><img src=\"logo_mes_infos.png\" class=\"logo\"/></div></div><div class=\"row\"><br/></div></div></div><form role=\"form\" action=\"postFoodfacts\" method=\"post\"><div class=\"content\"><div id=\"dataContainer\" class=\"container\"><table><tr><td class=\"col-md-2\"><img src=\"openfoodfacts-logo-fr.png\"/></td><td class=\"col-md-7\"><p><br/>Ce formulaire vous permet de lister les produits dont les informations nutritionnelles n\\'ont pas été saisies dans la base de données ' + ((interp = OpenFoodFacts) == null ? '' : interp) + '.<br/>\\nles informations saisies ici seront envoyées à ' + ((interp = OpenFoodFacts) == null ? '' : interp) + ' pour réutilisation par d\\'autre personnes du panel MesInfos et plus généralement par tous les utilisateurs de la base de donnée ouverte ' + ((interp = OpenFoodFacts) == null ? '' : interp) + '.<br/>\\nMerci de saisir les données nutritionnelles avec soins.</p></td><td style=\"vertical-align:bottom;padding-right:0px\" class=\"col-md-3\"><input type=\"image\" src=\"bout_envoyer.jpg\" alt=\"Envoyer les modifications\" class=\"pull-right\"/></td></tr></table></div></div><div class=\"container\"><div class=\"row\"><div class=\"col-md-12\"><br/><table class=\"table table-striped table-hover table-condensed\"><thead><th class=\"col-md-0\">Code barre</th><th class=\"col-md-7\">Nom de l\\'article</th><th class=\"col-md-1 text-center\"> <img src=\"picto_poids.png\"/><br/>Poid&nbsp;(g)</th><th class=\"col-md-1 text-center\"> <img src=\"picto_calories.png\"/><br/>Calories&nbsp;(Kj)</th><th class=\"col-md-1 text-center\"> <img src=\"picto_calories.png\"/><br/> Lipides&nbsp;(g)</th><th class=\"col-md-1 text-center\"> <img src=\"picto_proteines.png\"/><br/>Proteines&nbsp;(g)</th><th class=\"col-md-1 text-center\"> <img src=\"picto_glucides.png\"/><br/>Glucides&nbsp;(g)</th></thead><tbody id=\"products-body\"></tbody></table><div class=\"pull-right\"><input type=\"image\" src=\"bout_envoyer.jpg\" alt=\"Envoyer les modifications\"/></div></div></div></div></form>');\n}\nbuf.push('<script id=\"template-row\" type=\"text/html\"><tr><td style=\"vertical-align:middle\"> <img src=\"http://drive.intermarche.com/ressources/images/produit/vignette/0<%= barcode %>.jpg\" width=\"53\" height=\"53\" title=\"code barre : <%= barcode %>&#10;Libellé Intermarché : <%= shop_label %>\" alt=\"<%= shop_label %>\" class=\"image\"/></td><td width=\"100%\"><input name=\"changed_<%= barcode %>\" type=\"hidden\" value=\"false\"/><input name=\"name_<%= barcode %>\" type=\"text\" placeholder=\"Nom de l\\'article\" value=\"<%= name?name:\\'\\' %>\" width=\"100%\" class=\"form-control\"/></td><td><div class=\"input-group\"><input name=\"weight_<%= barcode %>\" type=\"text\" placeholder=\"poid\" value=\"<%= (typeof weight != \\'undefined\\')?weight:\\'\\' %>\" class=\"form-control\"/><span class=\"input-group-addon\"><%= weightUnit %></span></div></td><td><div class=\"input-group\"><input name=\"energy_<%= barcode %>\" type=\"text\" placeholder=\"energy\" value=\"<%= (typeof energy != \\'undefined\\')?energy:\\'\\' %>\" class=\"form-control\"/><span class=\"input-group-addon\">Kj</span></div></td><td><div class=\"input-group\"><input name=\"fat_<%= barcode %>\" type=\"text\" placeholder=\"lipides\" value=\"<%= (typeof fat != \\'undefined\\')?fat:\\'\\' %>\" class=\"form-control\"/><span class=\"input-group-addon\">g</span></div></td><td><div class=\"input-group\"><input name=\"proteins_<%= barcode %>\" type=\"text\" placeholder=\"protéines\" value=\"<%= (typeof proteins != \\'undefined\\')?proteins:\\'\\' %>\" class=\"form-control\"/><span class=\"input-group-addon\">g</span></div></td><td><div class=\"input-group\"><input name=\"carbohydrates_<%= barcode %>\" type=\"text\" placeholder=\"glucides\" value=\"<%= (typeof carbohydrates != \\'undefined\\')?carbohydrates:\\'\\' %>\" class=\"form-control\"/><span class=\"input-group-addon\">g</span></div></td><td style=\"vertical-align:middle\"><%= new Date(last_update).toLocaleDateString() %></td></tr></script>');\n}\nreturn buf.join(\"\");\n};","module.exports = function anonymous(locals, attrs, escape, rethrow, merge) {\nattrs = attrs || jade.attrs; escape = escape || jade.escape; rethrow = rethrow || jade.rethrow; merge = merge || jade.merge;\nvar buf = [];\nwith (locals || {}) {\nvar interp;\nvar MesInfoNutritionelles = (\"<strong>Mes Infos <span style='font-style:italic'>Nutritionnelles</style></strong>\");\nvar OpenFoodFacts = (\"<strong><span style='color:red'>Ope</span><span style='color:orange'>nFoo</span><span style='color:green'>dFac</span><span style='color:blue'>ts</span></strong>\");\nbuf.push('<div><script id=\"header\" type=\"text/html\"><div class=\"col-md-12\"><H2> <span>Détail des achats du <%= new Date(day).toLocaleDateString() %></span></H2><p>Vous pouvez voir et corriger ici les infos nutritionnelles associées au ticket de caisse selectionné.<br/>\\nLes informations saisies ici seront envoyées à ' + ((interp = OpenFoodFacts) == null ? '' : interp) + ' pour réutilisation par d\\'autre personnes du panel MesInfos et plus généralement par tous les utilisateurs de la base de données ouverte ' + ((interp = OpenFoodFacts) == null ? '' : interp) + '.<br/>\\nMerci de saisir les données nutritionnelles avec soin.\\nLes statisiques ' + ((interp = MesInfoNutritionelles) == null ? '' : interp) + ' seront mises à jour immédiatement après correction.<br/></p></div><div class=\"col-md-12\"><form role=\"form\" action=\"postFoodfacts\" method=\"post\"><div class=\"pull-right\"><br><input type=\"image\" src=\"bout_envoyer.jpg\" alt=\"Envoyer les modifications\"/><br><br></div><table class=\"table table-striped table-hover table-condensed\"><thead><th class=\"col-md-0\">Code barre</th><th class=\"col-md-7\">Nom de l\\'article</th><th class=\"col-md-1 text-center\"> <img src=\"picto_poids.png\"/><br/>Poid&nbsp;(g)</th><th class=\"col-md-1 text-center\"> <img src=\"picto_calories.png\"/><br/>Calories&nbsp;(Kj)</th><th class=\"col-md-1 text-center\"> <img src=\"picto_calories.png\"/><br/> Lipides&nbsp;(g)</th><th class=\"col-md-1 text-center\"> <img src=\"picto_proteines.png\"/><br/>Proteines&nbsp;(g)</th><th class=\"col-md-1 text-center\"> <img src=\"picto_glucides.png\"/><br/>Glucides&nbsp;(g)</th></thead><tbody id=\"products-body\"></tbody></table><div class=\"pull-right\"><br><br><input type=\"image\" src=\"bout_envoyer.jpg\" alt=\"Envoyer les modifications\"/></div></form></div></script><script id=\"template-row\" type=\"text/html\"><tr><td style=\"vertical-align:middle\"> <img src=\"http://drive.intermarche.com/ressources/images/produit/vignette/0<%= barcode %>.jpg\" width=\"53\" height=\"53\" title=\"code barre : <%= barcode %>&#10;Libellé Intermarché : <%= shop_label %>\" alt=\"<%= shop_label %>\" class=\"image\"/></td><td><input name=\"changed_<%= barcode %>\" type=\"hidden\" value=\"false\"/><input name=\"name_<%= barcode %>\" type=\"text\" placeholder=\"Nom de l\\'article\" value=\"<%= name?name:\\'\\' %>\" class=\"form-control\"/></td><td><div class=\"input-group\"><input name=\"weight_<%= barcode %>\" type=\"text\" placeholder=\"poid\" value=\"<%= (typeof weight != \\'undefined\\')?weight:\\'\\' %>\" class=\"form-control\"/><span class=\"input-group-addon\">g</span></div></td><td><div class=\"input-group\"><input name=\"energy_<%= barcode %>\" type=\"text\" placeholder=\"energy\" value=\"<%= (typeof energy != \\'undefined\\')?energy:\\'\\' %>\" class=\"form-control\"/><span class=\"input-group-addon\">Kj</span></div></td><td><div class=\"input-group\"><input name=\"fat_<%= barcode %>\" type=\"text\" placeholder=\"lipides\" value=\"<%= (typeof fat != \\'undefined\\')?fat:\\'\\' %>\" class=\"form-control\"/><span class=\"input-group-addon\">g</span></div></td><td><div class=\"input-group\"><input name=\"proteins_<%= barcode %>\" type=\"text\" placeholder=\"protéines\" value=\"<%= (typeof proteins != \\'undefined\\')?proteins:\\'\\' %>\" class=\"form-control\"/><span class=\"input-group-addon\">g</span></div></td><td><div class=\"input-group\"><input name=\"carbohydrates_<%= barcode %>\" type=\"text\" placeholder=\"glucides\" value=\"<%= (typeof carbohydrates != \\'undefined\\')?carbohydrates:\\'\\' %>\" class=\"form-control\"/><span class=\"input-group-addon\">g</span></div></td></tr></script></div>');\n}\nreturn buf.join(\"\");\n};","module.exports = function anonymous(locals, attrs, escape, rethrow, merge) {\nattrs = attrs || jade.attrs; escape = escape || jade.escape; rethrow = rethrow || jade.rethrow; merge = merge || jade.merge;\nvar buf = [];\nwith (locals || {}) {\nvar interp;\nbuf.push('<div id=\"loader\"><img src=\"loader.gif\" alt=\"je charge\"/></div><nav role=\"navigation\" class=\"navbar navbar-default navbar-fixed-top\"><div class=\"container\"><div class=\"navbar-header\"><button type=\"button\" data-toggle=\"collapse\" data-target=\".navbar-collapse\" class=\"navbar-toggle\"><span class=\"icon-bar\"></span><span class=\"icon-bar\"></span><span class=\"icon-bar\"></span></button><a href=\"#info\" class=\"navbar-brand\">MesInfos Nutritionelles</a></div><div class=\"navbar-collapse collapse\"><ul class=\"nav navbar-nav\"><li id=\"statsMenuItem\"><a href=\"#stats\"> Mes Statistiques</a></li><li id=\"controlMenuItem\"><a href=\"#control\">Données Nutritionelles</a></li><li class=\"dropdown\"><a href=\"#\" data-toggle=\"dropdown\" class=\"dropdown-toggle\">A Propos<ul class=\"dropdown-menu\"><li> <a>Réalisation <strong>Lookal</strong> &copy; 2014 </a></li><li> <a href=\"mail:pdelorme@lookal.fr\">Contact <strong>pdelorme@lookal.fr</strong></a></li><li> <a>Merci à la Fing et à OpenFoodFacts pour leur assistance.<br/></a></li></ul></a></li></ul></div></div></nav><div id=\"tab-content\"></div>');\n}\nreturn buf.join(\"\");\n};","module.exports = function anonymous(locals, attrs, escape, rethrow, merge) {\nattrs = attrs || jade.attrs; escape = escape || jade.escape; rethrow = rethrow || jade.rethrow; merge = merge || jade.merge;\nvar buf = [];\nwith (locals || {}) {\nvar interp;\nvar MesInfoNutritionelles = (\"<strong> <span style='font-style:italic'>Mes Infos</span> Nutritionnelles</strong>\");\nvar OpenFoodFacts = (\"<strong><span style='color:red'>Ope</span><span style='color:orange'>nFoo</span><span style='color:green'>dFac</span><span style='color:blue'>ts</span></strong>\");\n{\nbuf.push('<div class=\"header\"><div class=\"container\"><div class=\"row\"><div class=\"col-md-11\"><H2> <span>MesInfos Nutritionelles</span></H2><p class=\"col-md-8\">' + ((interp = MesInfoNutritionelles) == null ? '' : interp) + ' vous permet de suivre votre nutrition en se basant directement sur vos tickets d\\'achat Intermarché.<br/>\\nElle vous permet de suivre votre consommation en calories, protides, lipides, glucides à la source sans avoir à peser quotidiennement vos aliments pour faire un suivi nutritionnel précis.</p></div><div class=\"col-md-1\"><img src=\"logo_mes_infos.png\" class=\"logo\"/></div></div></div></div><div style=\"height:240px\" class=\"content\"><div class=\"container\"><br/><br/><div class=\"row\"><div class=\"col-md-12 text-center\"><img src=\"schema_home.png\"/></div><div class=\"col-md-9\"></div></div></div></div><div class=\"container\"><br/><br/><br/><br/><div class=\"row\"><div class=\"col-md-2\"><p>&nbsp;</p></div><div class=\"col-md-8\"><p>' + ((interp = MesInfoNutritionelles) == null ? '' : interp) + ' fonctionne en croisant vos informations d\\'achat avec la base de données ouverte ' + ((interp = OpenFoodFacts) == null ? '' : interp) + '. <br/>\\nCette base de données référence les données nutritionnelles de dizaines de milliers d\\'articles de consommation courante. <br/>\\nCependant elle ne recense pas tous les produits et l\\'application ' + ((interp = MesInfoNutritionelles) == null ? '' : interp) + ' vous permet d\\'ajouter vos articles le plus simplement du monde à la base de données ' + ((interp = OpenFoodFacts) == null ? '' : interp) + ' afin de pouvoir en bénéficier dans vos statistiques de consommation.<br/>\\nLes informations nutritionnelles saisies par vous sont immédiatement accessible aux autres utilisateurs de l\\'application ' + ((interp = MesInfoNutritionelles) == null ? '' : interp) + ' ainsi qu\\'à tous les utilisateurs de la base ' + ((interp = OpenFoodFacts) == null ? '' : interp) + '. </p></div></div></div>');\n}\n}\nreturn buf.join(\"\");\n};","module.exports = function anonymous(locals, attrs, escape, rethrow, merge) {\nattrs = attrs || jade.attrs; escape = escape || jade.escape; rethrow = rethrow || jade.rethrow; merge = merge || jade.merge;\nvar buf = [];\nwith (locals || {}) {\nvar interp;\nvar MesInfoNutritionelles = (\"<strong> <span style='font-style:italic'>Mes Infos</span> Nutritionnelles</strong>\");\nvar OpenFoodFacts = (\"<strong><span style='color:red'>Ope</span><span style='color:orange'>nFoo</span><span style='color:green'>dFac</span><span style='color:blue'>ts</span></strong>\");\nbuf.push('<div id=\"all\"><div class=\"header\"><div class=\"container\"><div class=\"row\"><div class=\"col-md-11\"><H2> <span>Statistiques d\\'achat nutritionnelles</span></H2><p class=\"col-md-8\">Ce diagramme montre les calories, protéines, lipides et glucides par date d\\'achat et étalés dans le temps.<br/>\\nEn cliquant sur une date, vous pourrez voir la liste des achats du jour et vérifier/compléter les informations nutritionnelles de chaque produit afin de corriger votre diagramme.</p></div><div class=\"col-md-1\"><img src=\"logo_mes_infos.png\" class=\"logo\"/></div></div></div></div><div id=\"chartContainer\" class=\"content\"><div class=\"container\"><br/><br/><div class=\"row\"><div class=\"col-md-12 chart\"><div class=\"col-md-6\"><div id=\"chartEnergyContainer\"></div></div><div class=\"col-md-6\"><div id=\"chartNutritionContainer\"></div></div></div><div class=\"col-md-12\"><div class=\"col-md-6\"><div class=\"text-center\"> <img src=\"titre_energie.png\"/></div><br/></div><div class=\"col-md-6\"><div class=\"text-center\"> <img src=\"titre_compo_nutri.png\"/></div></div></div></div></div></div><div class=\"container\"><div class=\"row\"><div id=\"dataContainer\"></div></div></div></div>');\n}\nreturn buf.join(\"\");\n};","var StatsView = require('./info_view');\nvar StatsView = require('./stats_view');\nvar CoachView = require('./coach_view');\nvar ControlView = require('./control_view');\nvar DataView = require('./data_view');\n\nmodule.exports = AppView = Backbone.View.extend({\n\n    el: 'body',\n    template: require('../templates/home'),\n    events: {\n    },\n\n    // initialize is automatically called once after the view is constructed\n    initialize: function() {\n      //update view in db.\n      $.get('touch',function(){\n        console.log('get finished');\n      });\n      console.log('init finished');\n    },\n\n    render: function() {\n        // we render the template\n        this.$el.html(this.template());\n\n    },\n\n    infoView: function(event) {\n    \t$(\"#loader\").show();\n    \tthis.activateMenu(\"#infoMenuItem\");\n        // render the stats view\n        infoView = new InfoView();\n        infoView.render();\n        this.$el.find('#tab-content').html(infoView.$el);\n        $(\"#loader\").hide();\n    },\n    \n    statsView: function(event) {\n    \t$(\"#loader\").show();\n    \tthis.activateMenu(\"#statsMenuItem\");\n    \t// render the stats view\n    \tstatsView = new StatsView();\n    \tstatsView.render();\n    \tthis.$el.find('#tab-content').html(statsView.$el);\n    \t$(\"#loader\").hide();\n    },\n    \n    coachView:function(event){\n    \t$(\"#loader\").show();\n    \tthis.activateMenu(\"#coachMenuItem\");\n\t\tcoachView = new CoachView();\n\t    coachView.render();\n\t    this.$el.find('#tab-content').html(coachView.$el);\n        $(\"#loader\").hide();\n    },\n    \n    controlView:function(event){\n    \t$(\"#loader\").show();\n    \tthis.activateMenu(\"#controlMenuItem\");\n\t\tcontrolView = new ControlView();\n\t    controlView.render();\n\t    this.$el.find('#tab-content').html(controlView.$el);\n        $(\"#loader\").hide();\n    },\n    \n    activateMenu: function(elem){\n    \t$(\"#loader\").show();\n    \t// disable all menus.\n    \t$(\".navbar-nav li\").removeClass(\"active\");\n    \t// activate menu.\n    \t$(elem).addClass(\"active\");\n    \t$(\"#loader\").hide();\n    }\n});","//var SectionView = require('./section');\nvar ReceiptCollection = require('../collections/receipts');\n\nmodule.exports = StatsView = Backbone.View.extend({\n\n    tagName: 'div',\n    template: require('../templates/coach'),\n    events: {\n        //\"click .receipt\": \"toggleSections\",    \n        //\"click .toggle\": \"toggleSectionsNoDefault\"    \n    },\n\n    initialize: function() {\n        // this.collection = new ReceiptCollection([], { receiptId: this.model.attributes.receiptId });\n        \n    },\n\n    render: function() {\n        this.$el.html(this.template({\n            receipt: this.model.toJSON()\n        }));\n    },\n    \n});\n\n","//var SectionView = require('./section');\nvar ReceiptCollection = require('../collections/receipts');\n\nmodule.exports = ControlView = Backbone.View.extend({\n\n    tagName: 'div',\n    template: require('../templates/control'),\n    events: {\n    \t\"submit form\":\"postData\",\n    \t\"change input.form-control\" : \"formChange\"\n    },\n\n    initialize: function() {\n    },\n\n    render: function() {\n        this.$el.html(this.template());\n        var that = this;\n        // async to allow proper refresh.\n        setTimeout(function(){\n        \tthat.getData();\n        },0);        \n    },\n    \n    getData: function(){\n    \t$(\"#loader\").show();\n    \t// asks server for product without infos.\n    \tvar that = this;\n    \tvar productBody = this.$el.find(\"#products-body\");\n    \tproductBody.html(\"\");\n    \tvar productRowTemplate = _.template(this.$el.find(\"#template-row\").html());\n    \t$.getJSON('invalidProducts', function(data) {\n        \tproductBody.html(\"\");\n    \t\t$.each(data, function(key, val) {\n    \t\t\tproductBody.append(productRowTemplate(val));\n    \t\t});\n        \t$(\"#loader\").hide();\n    \t});\n    },\n    \n    postData: function(e){\n    \t$(\"#loader\").show();\n    \te.preventDefault();\n    \tvar formData = $(\"form\").serialize();\n    \tvar productBody = this.$el.find(\"#products-body\");\n    \tvar productRowTemplate = _.template(this.$el.find(\"#template-row\").html());\n    \tvar that = this;\n    \t\n    \t$.ajax({\n\t\t  type: \"POST\",\n\t\t  url: 'postFoodfacts',\n\t\t  data: formData,\n\t\t  dataType: \"json\",\n          beforeSend: function(){$(\"#modal-overlay\").show();},\n          complete: function(){$(\"#modal-overlay\").hide();},\n\t\t  success: function(data) {\n\t        \tthat.getData();\n\t    \t},\n\t\t});\n    },\n    formChange: function(e){\n    \tvar id = e.target.name.split('_')[1];\n    \t$(\"[name='changed_\"+id+\"']\").val(\"true\");\n    }\n    \n});\n\n","//var SectionView = require('./section');\nvar ReceiptCollection = require('../collections/receipts');\n\nmodule.exports = DataView = Backbone.View.extend({\n\n    tagName: 'div',\n    template: require('../templates/data'),\n    events: {\n    \t\"submit form\":\"postData\",\n    \t\"change input.form-control\" : \"formChange\"\n        //\"click .receipt\": \"toggleSections\",    \n        //\"click .toggle\": \"toggleSectionsNoDefault\"    \n    },\n\n    initialize: function() {\n        // this.collection = new ReceiptCollection([], { receiptId: this.model.attributes.receiptId });\n        this.day = this.options.day;\n        this.statsView = this.options.statsView;\n    },\n\n    render: function() {\n    \tvar headerTemplate = _.template($(this.template()).find(\"#header\").html());\n        var html = headerTemplate({day:this.day});\n    \tthis.$el.html(html);\n        this.getData();\n    },\n    \n    getData: function(){\n    \t$(\"#show\").hide();\n    \t// asks server for product without infos.\n    \tvar that = this;\n    \tvar productBody = this.$el.find(\"#products-body\");\n    \tvar productRowTemplate = _.template($(this.template()).find(\"#template-row\").html());\n    \t$.getJSON('dayFacts?day='+this.day, function(data) {\n        \tproductBody.html(\"\");\n    \t\t$.each(data, function(key, val) {\n    \t\t\tproductBody.append(productRowTemplate(val));\n    \t\t});\n        \t$(\"#loader\").hide();\n            $(document).scrollTo(\"#dataContainer\",1000, {offset:-50});\n    \t});\n    },\n    \n    postData: function(e){\n    \t$(\"#loader\").show();\n    \te.preventDefault();\n    \tvar formData = $(\"form\").serialize();\n    \tvar that = this;\n    \t\n    \t$.ajax({\n\t\t  type: \"POST\",\n\t\t  url: 'postFoodfacts',\n\t\t  data: formData,\n\t\t  //dataType: \"json\",\n          beforeSend: function(){$(\"#modal-overlay\").show();},\n          complete: function(){ $(\"#modal-overlay\").hide();},\n\t\t  success: function(data) {\n\t\t\t  that.getData();\n\t\t\t  that.statsView.updateChart();\n\t    \t},\n\t\t});\n    \t\n//    \t$.postJSON('postFoodfacts', formData, function(data) {\n//        \tproductBody.html(\"\");\n//    \t\t$.each(data, function(key, val) {\n//    \t\t\tproductBody.append(productRowTemplate(val));\n//    \t\t});\n//    \t});\n    },\n    formChange: function(e){\n    \tvar id = e.target.name.split('_')[1];\n    \t$(\"[name='changed_\"+id+\"']\").val(\"true\");\n    }\n    \n});\n\n","//var SectionView = require('./section');\nvar ReceiptCollection = require('../collections/receipts');\n\nmodule.exports = InfoView = Backbone.View.extend({\n\n    tagName: 'div',\n    template: require('../templates/info'),\n    events: {\n    },\n\n    initialize: function() {\n    },\n\n    render: function() {\n        this.$el.html(this.template());\n    },\n    \n});\n\n","var ReceiptCollection = require('../collections/receipts');\n\nvar beige = \"247,246,226\";\nvar yellow = \"255,235,166\";\nvar black = \"47,53,67\";\nvar green = \"49,204,200\";\nvar pink = \"255,154,146\";\nvar red = \"235,105,92\";\n\nmodule.exports = StatsView = Backbone.View.extend({\n\n    tagName: 'div',\n    template: require('../templates/stats'),\n    events: {\n    },\n\n    initialize: function() {\n    },\n\n    render: function() {\n        this.$el.html(this.template());\n        var that = this;\n        // async to allow proper refresh.\n        setTimeout(function(){\n        \tthat.updateChart();\n        },0);\n    },\n    \n    updateChart: function (callback) {\n    \t$(\"#loader\").show();\n\n    \tvar energyPoints = [];\n    \tvar fatPoints = [];\n    \tvar proteinsPoints = [];\n    \tvar carbohydratesPoints = [];\n    \tvar averageEnergyPoints = [];\n    \tvar averageFatPoints = [];\n    \tvar averageProteinsPoints = [];\n    \tvar averageCarbohydratesPoints = [];\n    \tvar chartEnergyContainer = this.$el.find(\"#chartEnergyContainer\");\n    \tvar chartNutritionContainer = this.$el.find(\"#chartNutritionContainer\");\n    \tvar that = this;\n\t\tvar chartEnergy = new CanvasJS.Chart(chartEnergyContainer,{\n\t\t\t//zoomEnabled: true,\n\t\t    panEnabled: true, \n\t\t    backgroundColor: \"rgb(\"+yellow+\")\",\n\t\t    toolTip: {\n\t\t        borderColor:\"white\"//shared: \"false\"  //disable here. \n\t\t    },\n\t\t    title:{\n\t\t\t\tfontSize:15,\n\t\t\t\tfontFamily:\"arial\",\n\t\t\t\tfontWeight:\"normal\",\n\t\t\t\tpadding:0,\n\t\t\t\tmaring:0,\n\t\t\t\tverticalAlign: \"top\", // \"top\", \"center\", \"bottom\"\n\t\t        horizontalAlign: \"left\" // \"left\", \"right\", \"center\"\n\t\t        \t\n\t\t\t}, \n\t\t\taxisX:{\n\t\t\t   //labelAngle: 50,\n\t\t\t   valueFormatString: \"D MMM\",\n\t\t\t   labelFontFamily:\"arial\",\n\t\t\t   labelFontSize:1,\n\t\t\t   lineThickness:0,\n\t\t\t   gridThickness:0,\n\t\t\t   tickThickness:0,\n\t\t\t   interval:1000,\n\t\t\t   intervalType:\"week\"\n\t\t\t},\n\t\t\taxisY:{\n\t\t\t\t//title:\"Kilo Joules : Grammes\",\n\t\t\t\tvalueFormatString: \"0.##\",\n\t\t\t\tlabelFontSize:1,\n\t\t\t\t//labelFontColor:000,\n\t\t\t\tlineThickness:0,\n\t\t\t\tgridThickness:0,\n\t\t\t\ttickThickness:0,\n\t\t\t\tminimum:0,\n\t\t\t\tinterval:1000\n\t\t\t},\n\t\t\tlegend:{\n\t\t\t\tverticalAlign: \"bottom\",\n\t\t\t\thorizontalAlign: \"center\",\n\t\t\t\tfontSize: 15,\n\t\t\t\tfontFamily: \"arial\",\n\t\t\t\tfontColor:\"gray\"\n\t\t\t},\n\t\t\tdata: [\n\t\t\t       // energy\n\t\t\t       {\n\t\t\t    \t   type: \"area\",\n\t\t\t    \t   color: \"rgba(\"+green+\",.3)\",\n\t\t\t    \t   showInLegend: true,\n\t\t\t    \t   name:\"energie/jour (Kj)\",\n\t\t\t    \t   toolTipContent: \"<span style='\\\"'color: {color};'\\\"'>energie/jour</span> : {y} Kj\", \n\t\t\t    \t   dataPoints: averageEnergyPoints,\n\t\t\t    \t   markerType:\"none\",\n\t\t\t    \t   //markerColor:\"red\",\n\t\t\t       },\n\t\t\t       {\n\t\t\t    \t   type: \"column\",\n\t\t\t    \t   color: \"rgba(\"+green+\",.7)\",\n\t\t\t    \t   showInLegend: true,\n\t\t\t    \t   toolTipContent: \"<span style='\\\"'color: {color};'\\\"'>{x}</span> : {y} Kj\", \n\t\t\t    \t   name:\"energie (Kj)\",\n\t\t\t    \t   width:50,\n\t\t\t    \t   click: function(e){ \n\t\t\t    \t\t   that.showTicketData(e.dataPoint.x);\n\t\t\t    \t   },\n\t\t\t    \t   dataPoints: energyPoints,\n\t\t\t    \t   indexLabelPlacement:\"outside\",\n\t\t\t    \t   indexLabelOrientation:\"vertical\",\n\t\t\t    \t   indexLabelFontSize:15,\n\t\t\t    \t   indexLabelFontFamily: \"arial\",\n\t\t\t    \t   indexLabel: \"{x}\"\n\t\t\t       }\n\t\t\t ]\n\t\t});\n\t\tvar chartNutrition = new CanvasJS.Chart(chartNutritionContainer,{\n\t\t\t//zoomEnabled: true,\n\t\t    panEnabled: true, \n\t\t    backgroundColor: \"rgb(\"+yellow+\")\",\n\t\t    toolTip: {\n\t\t    \tborderColor:\"white\",\n\t\t        shared: \"true\"  //disable here. \n\t\t      },\n\t\t\ttitle:{\n\t\t\t\tfontFamily:\"arial\",\n\t\t\t\tfontSize:15,\n\t\t\t\tfontWeight:\"normal\",\n\t\t\t\tpadding:0,\n\t\t\t\tmaring:0,\n\t\t\t\tverticalAlign: \"top\", // \"top\", \"center\", \"bottom\"\n\t\t        horizontalAlign: \"left\" // \"left\", \"right\", \"center\"\n\t\t        \t\n\t\t\t}, \n\t\t\taxisX:{\n\t\t\t   labelAngle: 50,\n\t\t\t   valueFormatString: \"D MMM\",\n\t\t\t   labelFontFamily:\"arial\",\n\t\t\t   labelFontSize:1,\n\t\t\t   labelFontWeight:\"normal\",\n\t\t\t   lineThickness:0,\n\t\t\t   gridThickness:0,\n\t\t\t   tickThickness:1,\n\t\t\t   interval:1000,\n\t\t\t   intervalType:\"week\"\n\t\t\t},\n\t\t\taxisY:{\n\t\t\t\t//title:\"Kilo Joules : Grammes\",\n\t\t\t\tvalueFormatString: \"0.##\",\n\t\t\t\tlabelFontSize:1,\n\t\t\t\tlineThickness:0,\n\t\t\t\tgridThickness:0,\n\t\t\t\ttickThickness:0,\n\t\t\t\tminimum:0,\n\t\t\t\tinterval:1000\n\t\t\t},\n\t\t\tlegend:{\n\t\t\t\tverticalAlign: \"bottom\",\n\t\t\t\thorizontalAlign: \"center\",\n\t\t\t\tfontSize: 15,\n\t\t\t\tfontFamily: \"arial\",\n\t\t\t\tfontColor:\"gray\"\n\t\t\t},\n\t\t\tdata: [\n\t\t\t       // fat\n\t\t\t       {\n\t\t\t    \t   type: \"stackedColumn\",\n\t\t\t    \t   color: \"rgba(\"+black+\",.7)\",\n\t\t\t    \t   showInLegend: true,\n\t\t\t    \t   name:\"lipides (g)\",\n\t\t\t    \t   toolTipContent: \"<span style='\\\"'color: {color};'\\\"'>lipides </span>: {y} g\", \n\t\t\t    \t   click: function(e){ \n\t\t\t    \t\t   that.showTicketData(e.dataPoint.x);\n\t\t\t    \t   },\n\t\t\t    \t   dataPoints: fatPoints,\n\t\t\t    \t   indexLabelPlacement:\"outside\",\n\t\t\t    \t   indexLabelAngle:50,\n\t\t\t    \t   //indexLabel: \"{y}\"\n\t\t\t       },\n\t\t\t       {\n\t\t\t    \t   type: \"stackedArea\",\n\t\t\t    \t   color: \"rgba(\"+black+\",.3)\",\n\t\t\t    \t   //showInLegend: true,\n\t\t\t    \t   name:\"lipides/jour (g)\",\n\t\t\t    \t   toolTipContent: \"<span style='\\\"'color: {color};'\\\"'>lipides/jours </span>: {y} g/j\", \n\t\t\t    \t   dataPoints: averageFatPoints,\n\t\t\t    \t   markerType:\"none\"\n\t\t\t       },\n\t\t\t       // proteins\n\t\t\t       {\n\t\t\t    \t   type: \"stackedColumn\",\n\t\t\t    \t   color: \"rgba(\"+red+\",.7)\",\n\t\t\t    \t   showInLegend: true,\n\t\t\t    \t   name:\"protéines (g)\",\n\t\t\t    \t   toolTipContent: \"<span style='\\\"'color: {color};'\\\"'>protéines </span>: {y} g\", \n\t\t\t    \t   click: function(e){ \n\t\t\t    \t\t   that.showTicketData(e.dataPoint.x);\n\t\t\t    \t   },\n\t\t\t    \t   dataPoints: proteinsPoints,\n\t\t\t    \t   indexLabelPlacement:\"outside\",\n\t\t\t    \t   indexLabelAngle:50,\n\t\t\t    \t   //indexLabel: \"{y}\"\n\t\t\t       },\n\t\t\t       {\n\t\t\t    \t   type: \"stackedArea\",\n\t\t\t    \t   color: \"rgba(\"+red+\",.3)\",\n\t\t\t    \t   //showInLegend: true,\n\t\t\t    \t   toolTipContent: \"\", \n\t\t\t    \t   toolTipContent: \"<span style='\\\"'color: {color};'\\\"'>protéines/jours </span>: {y} g/j\", \n\t\t\t    \t   dataPoints: averageProteinsPoints,\n\t\t\t    \t   markerType:\"none\"\n\t\t\t       },\n\t\t\t       // carbohydrates\n\t\t\t       {\n\t\t\t    \t   type: \"stackedColumn\",\n\t\t\t    \t   color: \"rgba(\"+pink+\",.7)\",\n\t\t\t    \t   showInLegend: true,\n\t\t\t    \t   name:\"glucides (g)\",\n\t\t\t    \t   toolTipContent: \"<span style='\\\"'color: {color};'\\\"'>glucides </span>: {y} g\", \n\t\t\t    \t   click: function(e){ \n\t\t\t    \t\t   that.showTicketData(e.dataPoint.x);\n\t\t\t    \t   },\n\t\t\t    \t   dataPoints: carbohydratesPoints,\n\t\t\t    \t   indexLabelPlacement:\"outside\",\n\t\t\t    \t   indexLabelOrientation:\"vertical\",\n\t\t\t    \t   indexLabelFontSize:15,\n\t\t\t    \t   indexLabelFontFamily: \"arial\",\n\t\t\t    \t   indexLabel: \"{x}\"\n\t\t\t       },\n\t\t\t       {\n\t\t\t    \t   type: \"stackedArea\",\n\t\t\t    \t   color: \"rgba(\"+pink+\",.3)\",\n\t\t\t    \t   //showInLegend: true,\n\t\t\t    \t   name:\"glucides/jour (g)\",\n\t\t\t    \t   toolTipContent: \"<span style='\\\"'color: {color};'\\\"'>glucides/jours </span>: {y} g/j\", \n\t\t\t    \t   dataPoints: averageCarbohydratesPoints,\n\t\t\t    \t   markerType:\"none\"\n\t\t\t       }\n\t\t\t ]\n\t\t});\n\t\tthis.chartEnergy = chartEnergy;\n\t\tthis.chartNutrition = chartNutrition;\n\t\t// empty energyPoints.\n    \tenergyPoints.length = 0;\n    \taverageEnergyPoints.length = 0;\n    \tfatPoints.length = 0;\n    \taverageFatPoints.length = 0;\n    \tproteinsPoints.length = 0;\n    \taverageProteinsPoints.length = 0;\n    \tcarbohydratesPoints.length = 0;\n    \taverageCarbohydratesPoints.length = 0;\n\t\t// build stats.\n\t\t$.getJSON('receiptStats', function(data) {\n\t\t\tvar receiptStats = data;\n\t\t\tvar prevDay;\n\t\t\tvar prevEnergy;\n\t\t\tvar prevFat;\n\t\t\tvar prevProteins;\n\t\t\tvar prevCarbohydrates;\n\t\t\t$.each(receiptStats, function(key, val) {\n\t\t\t\tvar date = new Date(val.timestamp);\n\t\t\t\tvar day = new Date(date.getFullYear(), date.getMonth(), date.getDate());\n\t\t\t\tvar energy        = val.energy;\n\t\t\t\tvar fat           = val.fat;\n\t\t\t\tvar proteins      = val.proteins;\n\t\t\t\tvar carbohydrates = val.carbohydrates;\n\t\t\t\tif(prevDay){\n\t\t\t\t\tdays = ((day.getTime()-prevDay.getTime())/(1000*60*60*24));\n\t\t\t\t\tif(days==0) {\n\t\t\t\t\t\tlastEnergyPoint = energyPoints.pop();\n\t\t\t\t\t\tenergy = lastEnergyPoint.y + energy;\n\t\t\t\t\t\t\n\t\t\t\t\t\tlastFatPoint = fatPoints.pop();\n\t\t\t\t\t\tfat = lastFatPoint.y + fat;\n\t\t\t\t\t\t\n\t\t\t\t\t\tlastProteinsPoint = proteinsPoints.pop();\n\t\t\t\t\t\tproteins = lastProteinsPoint.y + proteins;\n\t\t\t\t\t\t\n\t\t\t\t\t\tlastCarbohydratesPoint = carbohydratesPoints.pop();\n\t\t\t\t\t\tcarbohydrates = lastCarbohydratesPoint.y + carbohydrates;\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tmeanEnergy = Math.round(prevEnergy / days * 100) / 100;\n\t\t\t\t\t\tmeanFat = Math.round(prevFat / days * 100) / 100;\n\t\t\t\t\t\tmeanProteins = Math.round(prevProteins / days * 100) / 100;\n\t\t\t\t\t\tmeanCarbohydrates = Math.round(prevCarbohydrates / days * 100) / 100;\n\n\t\t\t\t\t\t//for(var theTime = prevDay.getTime(); theTime<day.getTime(); theTime+=(1000*60*60*24)){\n\t\t\t\t\t\t\ttheTime=prevDay.getTime();\n\t\t\t\t\t\t\taverageEnergyPoints.push({x:new Date(theTime), y:meanEnergy});\n\t\t\t\t\t\t\taverageFatPoints.push({x:new Date(theTime), y:meanFat});\n\t\t\t\t\t\t\taverageProteinsPoints.push({x:new Date(theTime), y:meanProteins});\n\t\t\t\t\t\t\taverageCarbohydratesPoints.push({x:new Date(theTime), y:meanCarbohydrates});\n\t\t\t\t\t\t\ttheTime=day.getTime();\n\t\t\t\t\t\t\taverageEnergyPoints.push({x:new Date(theTime), y:meanEnergy});\n\t\t\t\t\t\t\taverageFatPoints.push({x:new Date(theTime), y:meanFat});\n\t\t\t\t\t\t\taverageProteinsPoints.push({x:new Date(theTime), y:meanProteins});\n\t\t\t\t\t\t\taverageCarbohydratesPoints.push({x:new Date(theTime), y:meanCarbohydrates});\n\t\t\t\t\t\t//}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tprevDay           = day;\n\t\t\t\tprevEnergy        = energy;\n\t\t\t\tprevFat           = fat;\n\t\t\t\tprevProteins      = proteins;\n\t\t\t\tprevCarbohydrates = carbohydrates;\n\t\t\t\tconsole.log(day, energy, fat, proteins, carbohydrates);\n\t\t\t\tenergyPoints.push({x:day, y: Math.round(energy*100)/100});\n\t\t\t\tfatPoints.push({x:day, y: Math.round(fat*100)/100});\n\t\t\t\tproteinsPoints.push({x:day, y: Math.round(proteins*100)/100});\n\t\t\t\tcarbohydratesPoints.push({x:day, y: Math.round(carbohydrates*100)/100});\n\t\t\t});\n\t\t\tconsole.log(\"nb points:\",energyPoints.length);\n\t\t\t\n\t\t\t// refresh view.\n\t\t\tchartEnergy.render();\n\t\t\tchartNutrition.render();\n\t    \t$(\"#loader\").hide();\n\t\t\tif(callback)\n\t\t\t\tcallback();\n\t\t});\n\t},\n    showTicketData : function(timestamp){\n    \t$(\"#loader\").show();\n    \tvar date = new Date(timestamp);\n\t\tvar day = new Date(date.getFullYear(), date.getMonth(), date.getDate());\n    \tdataView = new DataView({\n    \t\tstatsView:this,\n    \t\tday:day\n    \t});\n        dataView.render();\n        this.$el.find('#dataContainer').html(dataView.$el);\n    }\n\n});\n\n"]}